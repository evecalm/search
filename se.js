var cookie={mycookie:{},init:function(){var b,c,d,e,a=document.cookie;for(a=a.split("; "),b=[],c=0,d=a.length;d>c;c++)b=a[c].split("="),this.mycookie[b[0]]=unescape(b[1]);e=this.attr("lang"),this.setlang(e),void 0===this.attr("defaultType")&&this.attr("defaultType","search"),void 0===this.attr("defaultEngine")&&this.attr("defaultEngine","google"),void 0===this.attr("newin")&&this.attr("newin","1")},attr:function(a,b,c,d){if("undefined"==typeof b)return"undefined"==typeof this.mycookie[a]?void 0:this.mycookie[a];if("undefined"==typeof c)c="Sat, 19 Jan 2037 03:52:43 GMT";else{var e=new Date;e.setTime(e.getTime()+1e3*60*60*24*c),c=e.toGMTString()}return d=d?d:"/",b=escape(b),document.cookie=a+"="+b+";expires="+c+";path="+d,this.mycookie[a]=b,this.mycookie[a]},remove:function(a){var c,b=this.attr(a);return void 0!==b&&(c=new Date,c.setTime(c.getTime()-1),document.cookie=a+"="+b+";expires="+c.toGMTString(),delete this.mycookie[a]),!0},setlang:function(a){return void 0===a||"zh"!==a&&"en"!==a?(a=void 0===window.navigator.language?window.navigator.browserLanguage:window.navigator.language,"zh-cn"===a.toLowerCase()?this.attr("lang","zh"):this.attr("lang","en")):this.attr("lang",a)}};$.toJSONString=JSON.stringify||function(a){var c,d,e,f,b=typeof a;if("object"!=b||null===a)return"string"==b&&(a='"'+a+'"'),String(a);e=[],f=a&&a.constructor==Array;for(c in a)d=a[c],b=typeof d,"string"==b?d='"'+d+'"':"object"==b&&null!==d&&(d=JSON.stringify(d)),e.push((f?"":'"'+c+'":')+String(d));return(f?"[":"{")+String(e)+(f?"]":"}")},$(function(){function k(a,b,c){var i,d,e,f,h,j,k,l;try{d="",e="",f="",h=cookie.attr("bgimg"),g||(g=$.ajax({url:"assets/se.json",async:!1}).responseText,g=$.parseJSON(g)),i=g.placeholder[a];for(j in g.searches)if(g.searches.hasOwnProperty(j)){f=j==b?"checked":"",e+='<li><label><input type="radio" name="type" value="'+j+'" '+f+">"+g.searches[j][a]+"</label></li>",f=j==b?" current":"",d+='<ul class="'+j+f+'">',keys=g.searches[j].engines;for(k in keys)keys.hasOwnProperty(k)&&(f=k==c&&j==b?'class="current"':"",d+='<li data="'+k+'" '+f+">"+keys[k][a]+"</li>");d+="</ul>"}document.title=g.title[a],h&&($(document.body).css("background-image","url("+h+")"),$(".search-wrapper,.appinfo").addClass("trsprt-bg")),$("#switch-lang").html(g.lang[a]),$("#app-name").html(g.title[a]),$("#ico").addClass("ico-"+b),$("#ph").html(i),$("#search-btn").text(g.submit[a]),$("#search-engine-list").html(d),$("#search-cat").html(e),l=null,0===$("#search-engine-list ."+b).length&&(l=$("#search-engine-list ul:eq(0)"),b=l.attr("class"),l.addClass("current"),cookie.attr("defaultType",b)),0===$("#search-engine-list ."+b+" li.current").length&&(l=$("#search-engine-list ."+b+" li:eq(0)"),searchEngine=l.attr("data"),l.addClass("current"),cookie.attr("defaultEngine",searchEngine)),$("#search-cat input:checked").length||$("#search-cat li:eq(0) label").click(),n(b,c)}catch(m){alert("Init error! You may try to reload this page.")}}function l(){var b,a="";if(h=0,f=-1,c.length){for(h=c.length,b=0;h>b;++b)a+="<li>"+c[b]+"</li>";a+='<li id="clear-history">'+g.clearhistory[d]+"</li>"}return a}function m(){$("#sug").css({top:$(".search-form").offset().top+$(".search-form").height(),left:$(".search-form").offset().left})}function n(a,b){var e,c=g.searches[a].engines[b],d="";$("#search-form").attr("accept-charset",c.charset),$("#search-form").attr("action",c.url),$("#isa").attr("name",c.key);for(e in c.hiddens)c.hiddens.hasOwnProperty(e)&&(d+='<input type="hidden" name="'+e+'" value="'+c.hiddens[e]+'">');$("#hiddens").html(d),$("#link").attr("href",c.link)}function o(a,b){if(j[b]){var c;a=encodeURIComponent(a),c=j[b].replace("@",a);try{$.getJSON(c,function(a){var e,f,c=0,d="";if("shop"==b){if(e=a.result,c=e.length)for(f=0;c>f;++f)d+="<li>"+e[f][0]+"</li>"}else if(e=a.s,c=e.length)if("map"==b)for(f=0;c>f;++f)d+="<li>"+e[f].replace(/(\$)|(\d*$)/g," ")+"</li>";else for(f=0;c>f;++f)d+="<li>"+e[f]+"</li>";c?$("#sug").html(d).show():$("#sug").hide(),h=c})}catch(d){h=0}f=-1}}cookie.init();var a=cookie.attr("defaultType"),b=cookie.attr("defaultEngine"),c=$.parseJSON(cookie.attr("history"))||[],d=cookie.attr("lang"),e=!1,f=-1,g=null,h=0,i="",j={search:"http://suggestion.baidu.com/su?wd=@&p=3&cb=?",music:"http://nssug.baidu.com/su?wd=@&prod=mp3&cb=?",video:"http://nssug.baidu.com/su?wd=@&prod=video&cb=?",question:"http://nssug.baidu.com/su?wd=@&prod=zhidao&cb=?",image:"http://nssug.baidu.com/su?wd=@&ie=utf-8&prod=image&cb=?",map:"http://map.baidu.com/su?wd=@&ie=utf-8&cid=1&type=0&newmap=1&callback=?",doc:"http://nssug.baidu.com/su?wd=@&prod=wenku&oe=utf-8&cb=?",shop:"http://suggest.taobao.com/sug?area=etao&code=utf-8&q=@&callback=?"};!c instanceof Array&&(c=[]),k(d,a,b),m(),$("#sug").html(l()),$("#isa").on("click focus",function(a){a.stopPropagation(),$("#isa,#search-btn").addClass("box-shadow")}).focus(),$("#ph").on("click",function(a){a.stopPropagation(),$("#isa").focus()}),$(document).on("click",function(){$("#sug").hide(),$("#isa,#search-btn").removeClass("box-shadow"),$("#setting-icon").removeClass("current"),$("#setting-panel").hide()}),$(document).on("keydown",function(a){36===a.keyCode&&$("#isa").focus()}),$(window).on("resize",function(){m()}),$(window).on("focus",function(){$("#isa").focus()}),window.onbeforeunload=function(){cookie.attr("history",$.toJSONString(c)),cookie.attr("defaultType",a),cookie.attr("defaultEngine",b),cookie.attr("lang",d)},$("#switch-lang").on("click","span",function(){d=$(this).attr("data"),k(d,a,b)}),$("#setting-icon").on("click",function(a){a.stopPropagation(),$(this).addClass("current"),$("#setting-panel").show(),$("#bgimg").focus()}),$("#set-bgimg").on("click",function(a){a.stopPropagation();var d,e,b=$("#bgimg").val(),c=new Image;d=function(){$(document.body).css("background-image","url("+b+")"),$("#bgimg").val(""),cookie.attr("bgimg",b),$("#setting-icon").removeClass("current"),$("#setting-panel").hide(),$(".search-wrapper,.appinfo").addClass("trsprt-bg"),c=null},e=function(){$(document.body).css("background-image",""),cookie.attr("bgimg",""),$(".search-wrapper,.appinfo").removeClass("trsprt-bg"),$("#imgerror-tip").html(g.imgloaderror[cookie.attr("lang")]).show(),setTimeout(function(){$("#imgerror-tip").hide()},2e3),c=null},c.onerror=e,c.onload=d,b&&(c.src=b)}),$("#bgimg").on("keydown",function(a){return 13===a.keyCode?($("#set-bgimg").click(),!1):void 0}),$("#setting-panel").on("click",function(a){a.stopPropagation()}),$("#isa").on("input propertychange",function(){""===$(this).val()?($("#ph").show(),i="",e||$("#sug").html(l()).hide()):($("#ph").hide(),e||i==$(this).val()||(i=$(this).val(),o(i,a)))}),$("#isa").on("keydown",function(b){var l,m,c=!0,d=0,g="",j=$("#sug"),k=$("#ph");switch(e=!1,b.keyCode){case 9:b.shiftKey?(l=$("#search-cat li").length,m=0|$("#search-cat li input:checked").parents("li").index(),++m,m%=l,$("#search-cat li:eq("+m+") label").click(),$("#isa").focus()):(l=$("."+a+" li").length,m=0|$("."+a+" li.current").index(),++m,m%=l,$("."+a+" li:eq("+m+")").click()),c=!1;break;case 27:j.hide(),c=!1;break;case 38:if(!h)return c;e=!0,j.show(),k.hide(),d=f-1,-1>d&&(d=h-1),$("#sug li:eq("+f+")").removeClass("current"),g=-1==d?i:$("#sug li:eq("+d+")").addClass("current").text(),$(this).val(g),""===g&&$("#ph").show(),f=d,c=!1;break;case 40:if(!h)return c;e=!0,j.show(),k.hide(),d=f+1,d>=h&&(d=-1),$("#sug li:eq("+f+")").removeClass("current"),g=-1==d?i:$("#sug li:eq("+d+")").addClass("current").text(),$(this).val(g),""===g&&$("#ph").show(),f=d,c=!1}return c}),$("#sug").on("hover","li",function(){var a=$(this).index();a===f?$(this).addClass("current"):($("#sug li:eq("+f+")").removeClass("current"),$("#sug li:eq("+a+")").addClass("current"),f=a)}),$("#sug").on("click","li",function(a){return console.log(a),"clear-history"==a.srcElement.id?(c=[],h=0,$("#sug").html("").hide(),$("#isa").focus(),!1):(i=$(this).html(),$("#isa").val(i),$("#search-form").submit(),void 0)}),$("#search-cat").on("click","li label",function(){var c=$(this).children("input");a!=c.val()&&($("#search-engine-list ."+a+" li.current").removeClass("current"),$("#search-engine-list ."+a).removeClass("current"),$("#ico").removeClass("ico-"+a),a=c.val(),$("#ico").addClass("ico-"+a),$("#search-engine-list ."+a).addClass("current"),b=$("#search-engine-list ."+a+" li:eq(0)").addClass("current").attr("data"),n(a,b)),$("#isa").focus()}),$("#search-engine-list").on("click","ul li",function(){b!=$(this).attr("data")&&($("#search-engine-list ul li.current").removeClass("current"),b=$(this).addClass("current").attr("data"),n(a,b)),$("#isa").focus()}),$("#search-form").on("submit",function(){var d,e,f;if($("#sug").hide(),i=$("#isa").val(),""===i)return!1;if(" "===i||"qiyi"===b||"map"===a&&"baidu"===b)return"qiyi"===b?(d=$("#search-form").attr("action")+"q_",d+=encodeURIComponent(i),$("#link").attr("href",d)):"baidu"===b&&(d=$("#search-form").attr("action")+"?newmap=1&ie=utf-8&s=s%26wd%3D",d+=encodeURIComponent(i)+"%26c%3D1",$("#link").attr("href",d)),$("#link")[0].click(),!1;for(e=0,f=c.length;f>e;++e)if(i==c[e]){0!=e&&(c.splice(e,1),c.unshift(i));break}return e==f&&(f>9&&c.splice(9,f-10),c.unshift(i)),!0})});