var cookie={mycookie:{},init:function(){var e=document.cookie;e=e.split("; ");var d=[];for(var b=0,a=e.length;b<a;b++){d=e[b].split("=");this.mycookie[d[0]]=unescape(d[1])}var c=this.attr("lang");this.setlang(c);if(undefined===this.attr("defaultType")){this.attr("defaultType","search")}if(undefined===this.attr("defaultEngine")){this.attr("defaultEngine","google")}if(undefined===this.attr("newin")){this.attr("newin","1")}},attr:function(c,e,a,d){if(typeof(e)==="undefined"){return typeof(this.mycookie[c])==="undefined"?undefined:this.mycookie[c]}else{if(typeof(a)==="undefined"){a="Sat, 19 Jan 2037 03:52:43 GMT"}else{var b=new Date();b.setTime(b.getTime()+a*24*60*60*1000);a=b.toGMTString()}d=d?d:"/search/";e=escape(e);document.cookie=c+"="+e+";expires="+a+";path="+d+";";this.mycookie[c]=e;return this.mycookie[c]}},remove:function(b){var c=this.attr(b);if(undefined!==c){var a=new Date();a.setTime(a.getTime()-1);document.cookie=b+"="+c+";expires="+a.toGMTString();delete this.mycookie[b]}return true},setlang:function(a){if(undefined===a||("zh"!==a&&"en"!==a)){a=(undefined===window.navigator.language)?window.navigator.browserLanguage:window.navigator.language;if("zh-cn"===a.toLowerCase()){return this.attr("lang","zh")}else{return this.attr("lang","en")}}return this.attr("lang",a)}};var len=0,currentIndex=-1,isArrowKey=false,val="",config=null,currentType="",currentEngine="";$(function(){cookie.init();init_argv();init_SearchList();set_sug_pos();$("#isa").on("click focus",function(a){a.stopPropagation();$("#isa,#search-btn").addClass("box-shadow")}).focus();$("#ph").on("click",function(a){a.stopPropagation();$("#isa").focus()});$(document).on("click",function(){$("#sug").hide();$("#isa,#search-btn").removeClass("box-shadow");$("#setting-icon").removeClass("current");$("#setting-panel").hide()});$(document).on("keydown",function(a){if(a.keyCode===36){$("#isa").focus()}});$(window).on("resize",function(){set_sug_pos()});$(window).on("blur",function(){$("#sug").hide()});$(window).on("focus",function(){$("#isa").focus()});$("#switch-lang").on("click","span",function(){cookie.setlang($(this).attr("data"));init_SearchList()});$("#setting-icon").on("click",function(a){a.stopPropagation();$(this).addClass("current");$("#setting-panel").show();$("#bgimg").focus()});$("#set-bgimg").on("click",function(e){e.stopPropagation();var c=$("#bgimg").val(),b=new Image(),a,d;a=function(){$(document.body).css("background-image","url("+c+")");$("#bgimg").val("");cookie.attr("bgimg",c);$("#setting-icon").removeClass("current");$("#setting-panel").hide();$(".search-wrapper,.appinfo").addClass("trsprt-bg");b=null};d=function(){$(document.body).css("background-image","");cookie.attr("bgimg","");$(".search-wrapper,.appinfo").removeClass("trsprt-bg");$("#imgerror-tip").html(config.imgloaderror[cookie.attr("lang")]).show();setTimeout(function(){$("#imgerror-tip").hide()},2000);b=null};b.onerror=d;b.onload=a;if(c){b.src=c}});$("#bgimg").on("keydown",function(a){if(a.keyCode===13){$("#set-bgimg").click();return false}});$("#setting-panel").on("click",function(a){a.stopPropagation()});$("#isa").on("input propertychange",function(a){if(""===$(this).val()){$("#ph").show();$("#sug").hide();val=""}else{$("#ph").hide();if(!isArrowKey){if(val!=$(this).val()){val=$(this).val();getSug(val)}}}});$("#isa").on("keydown",function(e){var b=true,c=0,f="";isArrowKey=false;switch(e.keyCode){case 9:var d,a;if(e.shiftKey){d=$("#search-cat li").length;a=$("#search-cat li input:checked").parents("li").index()|0;++a;a%=d;$("#search-cat li:eq("+a+") label").click();$("#isa").focus()}else{d=$("."+currentType+" li").length;a=$("."+currentType+" li.current").index()|0;++a;a%=d;$("."+currentType+" li:eq("+a+")").click()}b=false;break;case 27:$("#sug").hide();b=false;break;case 38:if(!len){return b}isArrowKey=true;$("#sug").show();$("#ph").hide();c=currentIndex-1;if(c<-1){c=len-1}$("#sug li:eq("+currentIndex+")").removeClass("current");f=(-1==c)?val:$("#sug li:eq("+c+")").addClass("current").text();$(this).val(f);currentIndex=c;b=false;break;case 40:if(!len){return b}isArrowKey=true;$("#sug").show();$("#ph").hide();c=currentIndex+1;if(c>=len){c=-1}$("#sug li:eq("+currentIndex+")").removeClass("current");f=(-1==c)?val:$("#sug li:eq("+c+")").addClass("current").text();$(this).val(f);currentIndex=c;b=false;break;default:break}return b});$("#sug").on("hover","li",function(){var a=$(this).index();if(a===currentIndex){$(this).addClass("current")}else{$("#sug li:eq("+currentIndex+")").removeClass("current");$("#sug li:eq("+a+")").addClass("current");currentIndex=a}});$("#sug").on("click","li",function(a){val=$(this).html();$("#isa").val(val);$("#search-form").submit()});$("#search-cat").on("click","li label",function(){var a=$(this).children("input");if(currentType!=a.val()){$("#search-engine-list ."+currentType+" li.current").removeClass("current");$("#search-engine-list ."+currentType).removeClass("current");$("#ico").removeClass("ico-"+currentType);currentType=a.val();$("#ico").addClass("ico-"+currentType);$("#search-engine-list ."+currentType).addClass("current");currentEngine=$("#search-engine-list ."+currentType+" li:eq(0)").addClass("current").attr("data");changeSearchEngine()}$("#isa").focus()});$("#search-engine-list").on("click","ul li",function(){if(currentEngine!=$(this).attr("data")){$("#search-engine-list ul li.current").removeClass("current");currentEngine=$(this).addClass("current").attr("data");changeSearchEngine()}$("#isa").focus()});$("#search-form").on("submit",function(){$("#sug").hide();val=$("#isa").val();if(""===val){return false}else{if(" "===val||currentEngine==="qiyi"||(currentType==="map"&&currentEngine==="baidu")){var a;if(currentEngine==="qiyi"){a=$("#search-form").attr("action")+"q_";a+=encodeURIComponent(val);$("#link").attr("href",a)}else{if(currentEngine==="baidu"){a=$("#search-form").attr("action")+"?newmap=1&ie=utf-8&s=s%26wd%3D";a+=encodeURIComponent(val)+"%26c%3D1";$("#link").attr("href",a)}}$("#link")[0].click();return false}else{return true}}})});function getSug(b){b=encodeURIComponent(b);if(suggestionFun[currentType]){try{suggestionFun[currentType](b)}catch(a){len=0}}currentIndex=-1}var suggestionFun={search:function(b){var a="http://suggestion.baidu.com/su?wd="+b+"&p=3&cb=?";$.getJSON(a,function(d){len=d.s.length;var e="";for(var c=0;c<len;++c){e+="<li>"+d.s[c]+"</li>"}$("#sug").html(e);if(len){$("#sug").show()}else{$("#sug").hide()}})},music:function(b){var a="http://nssug.baidu.com/su?wd="+b+"&prod=mp3&cb=?";$.getJSON(a,function(d){len=d.s.length;var e="";for(var c=0;c<len;++c){e+="<li>"+d.s[c]+"</li>"}$("#sug").html(e);if(len){$("#sug").show()}else{$("#sug").hide()}})},video:function(b){var a="http://nssug.baidu.com/su?wd="+b+"&prod=video&cb=?";$.getJSON(a,function(d){len=d.s.length;var e="";for(var c=0;c<len;++c){e+="<li>"+d.s[c]+"</li>"}$("#sug").html(e);if(len){$("#sug").show()}else{$("#sug").hide()}})},question:function(b){var a="http://nssug.baidu.com/su?wd="+b+"&prod=zhidao&cb=?";$.getJSON(a,function(d){len=d.s.length;var e="";for(var c=0;c<len;++c){e+="<li>"+d.s[c]+"</li>"}$("#sug").html(e);if(len){$("#sug").show()}else{$("#sug").hide()}})},image:function(b){var a="http://nssug.baidu.com/su?wd="+b+"&ie=utf-8&prod=image&cb=?";$.getJSON(a,function(d){len=d.s.length;var e="";for(var c=0;c<len;++c){e+="<li>"+d.s[c]+"</li>"}$("#sug").html(e);if(len){$("#sug").show()}else{$("#sug").hide()}})},map:function(b){var a="http://map.baidu.com/su?wd="+b+"&ie=utf-8&cid=1&type=0&newmap=1&callback=?";$.getJSON(a,function(e){len=e.s.length;var f="",c;for(var d=0;d<len;++d){c=$.trim(e.s[d].replace(/\$/g," "));c=$.trim(c.replace(/ \d*$/,""));f+="<li>"+c+"</li>"}$("#sug").html(f);if(len){$("#sug").show()}else{$("#sug").hide()}})},doc:function(b){var a="http://nssug.baidu.com/su?wd="+b+"&prod=wenku&oe=utf-8&cb=?";$.getJSON(a,function(d){len=d.s.length;var e="";for(var c=0;c<len;++c){e+="<li>"+d.s[c]+"</li>"}$("#sug").html(e);if(len){$("#sug").show()}else{$("#sug").hide()}})},shop:function(b){var a="http://suggest.taobao.com/sug?area=etao&code=utf-8&q="+b+"&callback=?";$.getJSON(a,function(d){len=d.result.length;var e="";for(var c=0;c<len;++c){e+="<li>"+d.result[c][0]+"</li>"}$("#sug").html(e);if(len){$("#sug").show()}else{$("#sug").hide()}})}};function init_argv(){currentType=cookie.attr("defaultType");currentEngine=cookie.attr("defaultEngine")}function init_SearchList(){try{var k="",c=cookie.attr("lang"),g="",i="",a=cookie.attr("bgimg"),f;if(!config){config=$.ajax({url:"assets/se.json",async:false}).responseText;config=$.parseJSON(config)}f=config.placeholder[c];for(var j in config.searches){if(config.searches.hasOwnProperty(j)){i=(j==currentType)?"checked":"";g+='<li><label><input type="radio" name="type" value="'+j+'" '+i+">"+config.searches[j][c]+"</label></li>";i=(j==currentType)?" current":"";k+='<ul class="'+j+i+'">';keys=config.searches[j]["engines"];for(var d in keys){if(keys.hasOwnProperty(d)){i=(d==currentEngine&&j==currentType)?'class="current"':"";k+='<li data="'+d+'" '+i+">"+keys[d][c]+"</li>"}}k+="</ul>"}}document.title=config.title[c];if(a){$(document.body).css("background-image","url("+a+")");$(".search-wrapper,.appinfo").addClass("trsprt-bg")}$("#switch-lang").html(config.lang[c]);$("#app-name").html(config.title[c]);$("#ico").addClass("ico-"+currentType);$("#ph").html(f);$("#search-btn").text(config.submit[c]);$("#search-engine-list").html(k);$("#search-cat").html(g);var b=null;if(0===$("#search-engine-list ."+currentType).length){b=$("#search-engine-list ul:eq(0)");currentType=b.attr("class");b.addClass("current");cookie.attr("defaultType",currentType)}if(0===$("#search-engine-list ."+currentType+" li.current").length){b=$("#search-engine-list ."+currentType+" li:eq(0)");currentEngine=b.attr("data");b.addClass("current");cookie.attr("defaultEngine",currentEngine)}if(!$("#search-cat input:checked").length){$("#search-cat li:eq(0) label").click()}changeSearchEngine()}catch(h){alert("Init error! You may try to reload this page.")}}function set_sug_pos(){$("#sug").css({top:$(".search-form").offset().top+$(".search-form").height(),left:$(".search-form").offset().left})}function changeSearchEngine(){var b=config.searches[currentType]["engines"][currentEngine];$("#search-form").attr("accept-charset",b.charset);$("#search-form").attr("action",b.url);$("#isa").attr("name",b.key);var a="";for(var c in b.hiddens){if(b.hiddens.hasOwnProperty(c)){a+='<input type="hidden" name="'+c+'" value="'+b.hiddens[c]+'">'}}$("#hiddens").html(a);$("#link").attr("href",b.link)};