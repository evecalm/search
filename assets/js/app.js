var __indexOf=[].indexOf||function(t){for(var e=0,i=this.length;i>e;e++)if(e in this&&this[e]===t)return e;return-1};$(function(){var t,e,i,n,r,o,s,a,c,u,l,h,f,g;o="",r="",s="",$.toJSONString=window.JSON&&window.JSON.stringify||(g=function(t){var e,i,n,r,o;if(r=typeof t,"object"!==r||null===t)return"string"===r&&(t='"'+t+'"'),String(t);i=[],e=t&&t.constructor===Array;for(n in t)o=t[n],r=typeof o,"string"===r?o='"'+o+'"':"object"===r&&null!==o&&(o=g(o)),i.push((e?"":'"'+n+'"')+String(o));return e?"["+String(i)+"]":"{"+String(i)+"}"}),n={_cookie:function(){var t,e,i,n,r,o;for(e={},t=document.cookie.split("; "),r=0,o=t.length;o>r;r++)n=t[r],i=n.split("="),e[i[0]]=unescape(i[1]);return e}(),attr:function(t,e,i,n){var r;return void 0===e?void 0===this._cookie[t]?void 0:this._cookie[t]:(void 0===i?i="Sat, 19 Jan 2037 03:52:43 GMT":(r=new Date,r.setTime(r.getTime()+24*i*60*60*1e3),r=r.toGMTString()),n||(n="/"),e=escape(e),document.cookie=""+t+"="+e+";expires="+i+";path="+n,this._cookie[t]=e,this._cookie)},remove:function(t){var e,i;return i=this._cookie[t],null!=i&&(e=new Date,e.setTime(e.getTime-1),document.cookie=""+t+"="+i+";expires="+e.toGMTString()),this._cookie}},u={_MAX:10,_history:function(){var t;return t=n.attr("history"),t=t?$.parseJSON(t):[]}(),add:function(t){return __indexOf.call(this._history,t)<0&&(this._history.unshift(t),this._history.length>this._MAX&&this._history.pop(),n.attr("history",$.toJSONString(this._history))),this},clear:function(){return this._history.length=0,n.attr("history",$.toJSONString(this._history)),this},get:function(){return this._history}},e=function(t){var e,i;i=["en","zh"],i.indexOf(t)>-1&&(e=document.documentElement.className.replace(/lang\-[a-z]+/,""),e+=" lang-"+t,document.documentElement.className=e.replace(/^\s+|\s+$/g,""),null!=n&&n.attr("lang",t),document.title="zh"===t?"综合搜索":"Union Search")},h=function(){$("#sug").css({top:$(".search-form").offset().top+$(".search-form").height(),left:$(".search-form").offset().left})},f=function(t,e,i){var n,r,o,s,a,c,l,h,f,g,d,p,m;if(o=10,n=$("#sug"),r=$("#suglist"),r.html(""),s=0,c=u.get(),a="",i){for(h=0,d=c.length;d>h&&(l=c[h],!(s>=o));h++)++s,a+="<li>"+l+"</li>";$("#clear-history").show()}else{for(f=0,p=c.length;p>f&&(l=c[f],!(s>=o));f++)l.indexOf(t)>-1&&(++s,a+="<li class='s-h'>"+l+"</li>");$("#clear-history").hide()}if(e&&o>s)for(g=0,m=e.length;m>g&&(l=e[g],__indexOf.call(c,l)>=0||(++s,a+="<li>"+l+"</li>",!(s>=o)));g++);s?(r.html(a),n.show()):n.hide()},a=function(t,e,i){var n,r,o;if(o={search:"http://suggestion.baidu.com/su?wd=@&p=3&cb=?",music:"http://nssug.baidu.com/su?wd=@&prod=mp3&cb=?",video:"http://nssug.baidu.com/su?wd=@&prod=video&cb=?",question:"http://nssug.baidu.com/su?wd=@&prod=zhidao&cb=?",image:"http://nssug.baidu.com/su?wd=@&ie=utf-8&prod=image&cb=?",map:"http://map.baidu.com/su?wd=@&ie=utf-8&cid=1&type=0&newmap=1&callback=?",doc:"http://nssug.baidu.com/su?wd=@&prod=wenku&oe=utf-8&cb=?",shop:"http://suggest.taobao.com/sug?area=etao&code=utf-8&q=@&callback=?"},r=o[e],!r)return"function"==typeof i&&i(t),void 0;if(""===e||null==e)return"function"==typeof i&&i(t),void 0;r=r.replace("@",encodeURIComponent(t));try{$.getJSON(r,function(n){var r,o,s,a,c,u,l,h;switch(r=[],e){case"shop":for(l=n.result,s=0,c=l.length;c>s;s++)o=l[s],r.push(o[0]);break;case"map":for(h=n.s,a=0,u=h.length;u>a;a++)o=h[a],r.push($.trim(o.replace(/(\$+)/g," ")).replace(/\d+$/,""));break;default:r=n.s}"function"==typeof i&&i(t,r)})}catch(s){n=s,"function"==typeof i&&i(t)}},t=function(t){var e;return e=["64.233.168.97","173.194.124.55","74.125.110.236","173.194.21.233","173.194.124.108"],t.indexOf("www.google.com")>-1?t.replace("www.google.com",e[Math.floor(e.length*Math.random())]):t},i=function(t,e){var i,s,a,c,u,l,h,f,g;if(i=$("#search-engine-list"),null!=e&&(c=i.find(">ul[data-engine-type='"+e+"']")),e&&c.length||(c=i.find(">ul.current"),c.length||(c=i.find(">ul:first"))),e=c.data("engine-type"),$("#search-cat>li[data-type='"+e+"'] input").prop("checked",!0),i.find(">ul.current").removeClass("current"),c.addClass("current"),null!=t&&(a=c.find(">li[data-engine-name='"+t+"']")),t&&a.length||(a=c.find(">li.current"),a.length||(a=c.find(">li:first"))),t=a.data("engine-name"),c.find(">li.current").removeClass("current"),a.addClass("current"),s=$("#search-form"),u=a.data(),s.attr("accept-charset",u.charset||"utf-8"),s.attr("action",u.url),s.attr("origin-action",u.url),$("#isa").attr("name",u.key),$("#link").attr("href",u.link),$("#link").attr("origin-href",u.link),l=u.hiddens,h="",l)for(f in l)g=l[f],h+="<input type='hidden' name='"+f+"' value='"+g+"'>";$("#hiddens").html(h),n.attr("defaultType",e),n.attr("defaultEngine",t),o=e,r=t},c=function(t,e,i){var n;n=new Image,e&&(n.onload=e),i&&(n.onerror=i),n.src=t},l=function(t){""===t?(document.body.style.backgroundImage="",$("#search-wrapper").removeClass("trsprt-bg"),$("#footer").removeClass("trsprt-bg")):(document.body.style.backgroundImage="url("+t+")",$("#search-wrapper").addClass("trsprt-bg"),$("#footer").addClass("trsprt-bg"))},$("#isa").on("focus",function(t){t.stopPropagation(),$("#isa,#search-btn").addClass("box-shadow")}),function(){var t;t=n.attr("lang"),void 0===t&&(t=null!=window.navigator.language?window.navigator.language:window.navigator.browserLanguage,t="zh-cn"===t.toLowerCase()?"zh":"en"),e(t),i(n.attr("defaultEngine"),n.attr("defaultType")),l(n.attr("bgimg")),setTimeout(function(){$("#isa").focus()},0),h()}(),$("#search-engine-list").on("click","li",function(t){var e;return e=$(this),e.hasClass("current")||i(e.data("engine-name")),$("#isa").focus(),t.stopPropagation(),!1}),$("#search-cat").on("click","input",function(t){var e;e=$(this),i(null,e.closest("li").data("type")),$("#isa").focus(),t.stopPropagation()}),$("#search-form").on("submit",function(){var e,i,n,a;return i=$(this),e=$("#link"),$("#sug").hide(),a=$("#isa").val()," "===a?(n=t(e.attr("origin-href")),e.attr("href",n),e[0].click(),!1):""===a?!1:(s=a,u.add(a),n=t(i.attr("origin-action")),"qiyi"===r||"map"===o&&"baidu"===r?(n+="qiyi"===r?"q_"+encodeURIComponent(a):"?newmap=1&ie=utf-8&s=s%26wd%3D"+encodeURIComponent(a)+"%26c%3D1",e.attr("href",n),e[0].click(),!1):(i.attr("action",n),void 0))}),$("#search-wrapper").on("click",function(t){t.stopPropagation(),$("#isa").focus(),$("#sug").hide()}),$("#isa").on("click",function(t){t.stopPropagation(),""===this.value?f("",!1,!0):$("#suglist li").length&&$("#sug").show()}),$("#isa").on("input propertychange",function(){var t;t=$(this).val(),""===t?($("#ph").show(),$("#sug").hide(),$("#suglist").html(""),s=t):($("#ph").hide(),""!==$.trim(t)&&(s=t,a(t,o,f)))}),$("#isa").on("keydown",function(t){var e,i,n,r,o;switch(t.stopPropagation(),t.keyCode){case 9:t.shiftKey?(i=$("#search-cat"),r=i.find(">li input:checked").closest("li").next(),r.length||(r=i.find(">li:first")),r.find("input").trigger("click")):(i=$("#search-engine-list ul.current"),r=i.find(">li.current").next(),r.length||(r=i.find(">li:first")),r.trigger("click")),t.preventDefault();break;case 27:$("#sug").hide();break;case 38:$("#sug").is(":visible")?(t.preventDefault(),e=$("#suglist li.current"),e.length?(n=e.prev(),e.removeClass("current"),n.length||(n=!1)):n=$("#suglist li:last"),n?(n.addClass("current"),o=n.text()):o=s,o=$.trim(o),""===o?$("#ph").show():$("#ph").hide(),$("#isa").val(o)):$("#suglist li").length?(t.preventDefault(),$("#sug").show()):""===s&&f("",!1,!0);break;case 40:$("#sug").is(":visible")?(t.preventDefault(),e=$("#suglist li.current"),e.length?(n=e.next(),e.removeClass("current"),n.length||(n=!1)):n=$("#suglist li:first"),n?(n.addClass("current"),o=n.text()):o=s,o=$.trim(o),""===o?$("#ph").show():$("#ph").hide(),$("#isa").val(o)):$("#suglist li").length?(t.preventDefault(),$("#sug").show()):""===s&&f("",!1,!0)}}),$("#suglist").on("click","li",function(){var t;return t=$(this),t.addClass("current"),$("#ph").hide(),$("#isa").val($.trim(t.text())),$("#search-form").submit(),!1}),$("#suglist").on("hover","li",function(){var t;return t=$(this),t.parent().find("li").removeClass("current"),t.addClass("current"),!1}),$("#clear-history").on("click",function(){u.clear(),$("#suglist").html(""),$("#sug").hide(),$("#isa").focus()}),$("#clear-history").on("hover",function(){$("#suglist li").removeClass("current")}),$("#ph").on("click",function(){return $("#isa").focus(),!1}),$(document).on("click",function(){$("#isa,#search-btn").removeClass("box-shadow"),$("#sug").hide()}),$(document).on("keydown",function(t){if($("#overlay").is(":hidden")){if(36===t.keyCode||83===t.keyCode||70===t.keyCode)return $("#isa").focus(),!1}else 27===t.keyCode&&$("#overlay").trigger("click")}),$("#switch-lang").on("click","b",function(){e($(this).attr("lang"))}),$("#setting-icon").on("click",function(){$("#overlay").fadeIn("fast"),$("#setting-panel").fadeIn("fast"),$("#bgimg").focus()}),$("#bgimg").on("keydown",function(t){switch(t.keyCode){case 13:$("#set-bgimg").trigger("click");break;case 27:t.stopPropagation()}}),$("#set-bgimg").on("click",function(){var t,e;return t=$("#bgimg"),e=$.trim(t.val()),""!==e?c(e,function(){t.val(""),$("#overlay").trigger("click"),n.attr("bgimg",e),l(e)},function(){$("#imgerror-tip").show(),setTimeout(function(){$("#imgerror-tip").hide()},2e3),n.attr("bgimg",""),l("")}):void 0}),$("#overlay").on("click",function(){$("#setting-panel").fadeOut("fast"),$("#usage-content").fadeOut("fast"),$(this).fadeOut("fast"),setTimeout(function(){$("#isa").focus()},0)}),$("#usage").on("click",function(){$("#overlay").fadeIn("fast"),$("#usage-content").fadeIn("fast")}),$("#usage-close").on("click",function(){$("#overlay").trigger("click")}),$(window).on("resize",function(){h()}),$(window).on("focus",function(){$("#overlay").is(":hidden")&&$("#isa").focus()}),$(window).on("blur",function(){$("#sug").hide()})});