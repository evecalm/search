var indexOf=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};$(function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r;h="",g="",i="",c="",a=680,l=window.innerWidth<a,l&&$("#search-form").attr("target","_self"),j=[],$.toJSONString=window.JSON&&window.JSON.stringify||(r=function(a){var b,c,d,e,f;if(e=typeof a,"object"!==e||null===a)return"string"===e&&(a='"'+a+'"'),String(a);c=[],b=a&&a.constructor===Array;for(d in a)f=a[d],e=typeof f,"string"===e?f='"'+f+'"':"object"===e&&null!==f&&(f=r(f)),c.push((b?"":'"'+d+'"')+String(f));return b?"["+String(c)+"]":"{"+String(c)+"}"}),f=function(){return window.localStorage?{_loc:window.localStorage,attr:function(a,b){if(void 0===b){if(void 0===a)return;return this._loc.getItem(""+a)}return this._loc.setItem(""+a,""+b)},remove:function(a){return this._loc.removeItem(""+a)}}:{_cookie:function(){var a,b,c,d,e,f;for(d={},a=document.cookie.split("; "),b=0,c=a.length;c>b;b++)f=a[b],e=f.split("="),d[e[0]]=unescape(e[1]);return d}(),attr:function(a,b,c,d){var e;return void 0===b?this._cookie[a]:(void 0===c?c="Sat, 19 Jan 2037 03:52:43 GMT":(e=new Date,e.setTime(e.getTime()+24*c*60*60*1e3),e=e.toGMTString()),d||(d="/"),b=escape(b),document.cookie=a+"="+b+";expires="+c+";path="+d,this._cookie[a]=b,this._cookie)},remove:function(a){var b,c;return c=this._cookie[a],null!=c&&(b=new Date,delete this._cookie[a],b.setTime(b.getTime-1),document.cookie=a+"="+c+";expires="+b.toGMTString()),this._cookie}}}(),n={_MAX:10,_history:function(){var a;return a=f.attr("history"),a=a?$.parseJSON(a):[]}(),add:function(a){return indexOf.call(this._history,a)<0&&(this._history.unshift(a),this._history.length>this._MAX&&this._history.pop(),f.attr("history",$.toJSONString(this._history))),this},clear:function(){return this._history.length=0,f.attr("history",$.toJSONString(this._history)),this},get:function(){return this._history}},d=function(a){var b,d;d=["en","zh"],d.indexOf(a)>-1&&(c=a,b=document.documentElement.className.replace(/lang\-[a-z]+/,""),b+=" lang-"+a,document.documentElement.className=b.replace(/^\s+|\s+$/g,""),null!=f&&f.attr("lang",a),"zh"===a?document.title="综合搜索":document.title="Union Search")},p=function(){$("#sug").css({top:$(".search-form").offset().top+$(".search-form").height(),left:$(".search-form").offset().left})},q=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,o,p,q;if(f=10,d=$("#sug"),e=$("#suglist"),e.html(""),i=0,p=n.get(),m="",c){for(g=0,j=p.length;j>g&&(q=p[g],!(i>=f));g++)++i,m+="<li>"+q+"</li>";$("#clear-history").show()}else{for(h=0,k=p.length;k>h&&(q=p[h],!(i>=f));h++)q.indexOf(a)>-1&&(++i,m+="<li class='s-h'>"+q+"</li>");$("#clear-history").hide()}if(b&&f>i)for(o=0,l=b.length;l>o&&(q=b[o],indexOf.call(p,q)>=0||(++i,m+="<li>"+q+"</li>",!(i>=f)));o++);i?(e.html(m),d.show()):d.hide()},k=function(a,b,c){var d,e,f;if(f={search:"http://suggestion.baidu.com/su?wd=@&p=3&cb=?",music:"http://nssug.baidu.com/su?wd=@&prod=mp3&cb=?",video:"http://nssug.baidu.com/su?wd=@&prod=video&cb=?",question:"http://nssug.baidu.com/su?wd=@&prod=zhidao&cb=?",image:"http://nssug.baidu.com/su?wd=@&ie=utf-8&prod=image&cb=?",map:"http://map.baidu.com/su?wd=@&ie=utf-8&cid=1&type=0&newmap=1&callback=?",doc:"http://nssug.baidu.com/su?wd=@&prod=wenku&oe=utf-8&cb=?",shop:"http://suggest.taobao.com/sug?area=etao&code=utf-8&q=@&callback=?"},e=f[b],!e)return void("function"==typeof c&&c(a));if(""===b||null==b)return void("function"==typeof c&&c(a));e=e.replace("@",encodeURIComponent(a));try{$.getJSON(e,function(d){var e,f,g,h,i,j,k,l;switch(e=[],b){case"shop":for(k=d.result,g=0,i=k.length;i>g;g++)f=k[g],e.push(f[0]);break;case"map":for(l=d.s,h=0,j=l.length;j>h;h++)f=l[h],e.push($.trim($.trim(f.replace(/(\$+)/g," ")).replace(/\d+$/,"")));break;default:e=d.s}"function"==typeof c&&c(a,e)})}catch(g){d=g,"function"==typeof c&&c(a)}},b=function(a){return a.indexOf("www.google.com")>-1&&j.length?a.replace("www.google.com",j[Math.floor(j.length*Math.random())]):a},e=function(a,b){var d,e,i,j,k,l,m,n,o,p;if(d=$("#search-engine-list"),null!=b&&(k=d.find(">ul[data-engine-type='"+b+"']")),b&&k.length||(k=d.find(">ul.current"),k.length||(k=d.find(">ul:first"))),b=k.data("engine-type"),e=$("#search-cat>li[data-type='"+b+"']"),e.addClass("current"),$("#ico").attr("class","ico ico-"+b),e.find("input").prop("checked",!0),d.find(">ul.current").removeClass("current"),k.addClass("current"),null!=a&&(j=k.find(">li[data-engine-name='"+a+"']")),a&&j.length||(j=k.find(">li.current"),j.length||(j=k.find(">li:first"))),a=j.data("engine-name"),k.find(">li.current").removeClass("current"),j.addClass("current"),$(".search-powered-by").text(e.find("span."+c).text()+" / "+j.find("span."+c).text()),i=$("#search-form"),l=j.data(),i.attr("accept-charset",l.charset||"utf-8"),i.attr("action",l.url),i.attr("origin-action",l.url),$("#isa").attr("name",l.key),$("#link").attr("href",l.link),$("#link").attr("origin-href",l.link),m=l.hiddens,n="",m)for(o in m)p=m[o],n+="<input type='hidden' name='"+o+"' value='"+p+"'>";$("#hiddens").html(n),f.attr("defaultType",b),f.attr("defaultEngine",a),h=b,g=a},m=function(a,b,c){var d;d=new Image,b&&(d.onload=b),c&&(d.onerror=c),d.src=a},o=function(a){a?(document.body.style.backgroundImage="url("+a+")",$("#search-wrapper").addClass("trsprt-bg"),$("#footer").addClass("trsprt-bg")):(document.body.style.backgroundImage="",$("#search-wrapper").removeClass("trsprt-bg"),$("#footer").removeClass("trsprt-bg"))},$("#isa").on("focus",function(a){a.stopPropagation(),$("#isa,#search-btn").addClass("box-shadow")}),$("#search-engine-list").on("click","li",function(a){var b;return b=$(this),b.hasClass("current")||e(b.data("engine-name")),l&&($("#overlay").hide(),$("#search-engine-list").hide(),$("#search-cat").hide()),$("#isa").focus(),a.stopPropagation(),!1}),$("#search-cat").on("click","input",function(a){var b,c,d;c=$(this),d=c.closest("li").data("type"),b=c.closest("li"),e(null,b.data("type")),b.siblings().removeClass("current"),b.addClass("current"),!l&&$("#isa").focus(),a.stopPropagation()}),$("#search-form").on("submit",function(a){var c,d,e,f;return d=$(this),c=$("#link"),$("#sug").hide(),f=$("#isa").val()," "===f?(e=b(c.attr("origin-href")),c.attr("href",e),c[0].click(),!1):""===f?!1:(i=f,n.add(f),e=b(d.attr("origin-action")),"qiyi"===g||"map"===h&&"baidu"===g?(e+="qiyi"===g?"q_"+encodeURIComponent(f):"?newmap=1&ie=utf-8&s=s%26wd%3D"+encodeURIComponent(f)+"%26c%3D1",c.attr("href",e),c[0].click(),!1):void d.attr("action",e))}),$("#isa").on("click",function(a){a.stopPropagation(),""===this.value?q("",!1,!0):$("#suglist li").length&&$("#sug").show()}),$("#isa").on("input propertychange",function(a){var b;b=$(this).val(),""===b?($("#sug").hide(),$("#suglist").html(""),i=b):""!==$.trim(b)&&(i=b,k(b,h,q))}),$("#isa").on("keydown",function(a){var b,c,d,e,f;switch(a.stopPropagation(),a.keyCode){case 9:a.shiftKey?(c=$("#search-cat"),e=c.find(">li input:checked").closest("li").next(),e.length||(e=c.find(">li:first")),e.find("input").trigger("click")):(c=$("#search-engine-list ul.current"),e=c.find(">li.current").next(),e.length||(e=c.find(">li:first")),e.trigger("click")),a.preventDefault();break;case 27:$("#sug").hide();break;case 38:$("#sug").is(":visible")?(a.preventDefault(),b=$("#suglist li.current"),b.length?(d=b.prev(),b.removeClass("current"),d.length||(d=!1)):d=$("#suglist li:last"),d?(d.addClass("current"),f=d.text()):f=i,f=$.trim(f),$("#isa").val(f)):$("#suglist li").length?(a.preventDefault(),$("#sug").show()):""===i&&q("",!1,!0);break;case 40:$("#sug").is(":visible")?(a.preventDefault(),b=$("#suglist li.current"),b.length?(d=b.next(),b.removeClass("current"),d.length||(d=!1)):d=$("#suglist li:first"),d?(d.addClass("current"),f=d.text()):f=i,f=$.trim(f),$("#isa").val(f)):$("#suglist li").length?(a.preventDefault(),$("#sug").show()):""===i&&q("",!1,!0)}}),$("#suglist").on("click","li",function(){var a;return a=$(this),a.addClass("current"),$("#isa").val($.trim(a.text())),$("#search-form").submit(),!1}),$("#suglist").on("hover","li",function(){var a;return a=$(this),a.parent().find("li").removeClass("current"),a.addClass("current"),!1}),$("#clear-history").on("click",function(a){n.clear(),$("#suglist").html(""),$("#sug").hide(),$("#isa").focus()}),$("#clear-history").on("hover",function(a){$("#suglist li").removeClass("current")}),$(document).on("click",function(a){$("#isa,#search-btn").removeClass("box-shadow"),$("#sug").hide()}),$(document).on("keydown",function(a){if($("#overlay").is(":hidden")){if(36===a.keyCode||83===a.keyCode||70===a.keyCode)return $("#isa").focus(),!1}else 27===a.keyCode&&$("#overlay").trigger("click")}),$("#switch-lang").on("click","b",function(){d($(this).attr("lang"))}),$("#setting-icon").on("click",function(){$("#overlay").fadeIn("fast"),$("#setting-panel").fadeIn("fast"),$("#bgimg").focus()}),$("#bgimg").on("keydown",function(a){switch(a.keyCode){case 13:$("#set-bgimg").trigger("click");break;case 27:a.stopPropagation()}}),$("#set-bgimg").on("click",function(){var a,b;return a=$("#bgimg"),b=$.trim(a.val()),""!==b?m(b,function(){a.val(""),$("#overlay").trigger("click"),f.attr("bgimg",b),o(b)},function(){$("#imgerror-tip").show(),setTimeout(function(){$("#imgerror-tip").hide()},2e3),f.attr("bgimg",""),o("")}):void 0}),$("#overlay").on("click",function(){$("#setting-panel").fadeOut("fast"),$("#usage-content").fadeOut("fast"),l&&($("#search-engine-list").hide(),$("#search-cat").hide()),$(this).fadeOut("fast"),setTimeout(function(){$("#isa").focus()},0)}),$("#usage").on("click",function(){$("#overlay").fadeIn("fast"),$("#usage-content").fadeIn("fast")}),$("#usage-close").on("click",function(){$("#overlay").trigger("click")}),$("#hamburger").on("click",function(){return $("#overlay").show(),$("#search-engine-list").show(),$("#search-cat").show(),!1}),$(window).on("resize",function(){l=window.innerWidth<a,l&&$("#search-form").attr("target","_self"),p()}),$(window).on("focus",function(){$("#overlay").is(":hidden")&&$("#isa").focus()}),$(window).on("blur",function(){$("#sug").hide()}),function(){var a;a=f.attr("lang"),j=$.parseJSON(f.attr("ghosts")||"[]"),a||(a=null!=window.navigator.language?window.navigator.language:window.navigator.browserLanguage,a="zh-cn"===a.toLowerCase()?"zh":"en"),d(a),e(f.attr("defaultEngine"),f.attr("defaultType")),o(f.attr("bgimg")),$.getJSON("assets/google.json",function(a){$.isArray(a)&&(j=a,f.attr("ghosts",$.toJSONString(a)))}),setTimeout(function(){var a;$("#isa").focus(),navigator.userAgent.indexOf("Chrome")>-1&&(a="l2v2l6v2e1l1v3l2v3e1v7e1v7e1v7e1l2v6e1l4v5e1l6v4e1l8v3e1l7l3v2e1l9l3v1".replace(/[lve]\d/g,function(a){return Array(-~a[1]).join({l:" ",v:"Love",e:"\n"}[a[0]])}),console.log("%c%s\n%cThanks for your attention!\nYou can visit https://github.com/evecalm/search for uncompressed source code.\nHere is my website http://www.evecalm.com.","color: #ed5565;",a,"font-size: 18px;color:#068;font-weight: 400;"))},0),p()}()});